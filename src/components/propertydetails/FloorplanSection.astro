---
// ========================================
// FLOORPLAN SECTION COMPONENT
// Premium layered two-column composition
// Matches PropertyMapSection design language
// ========================================

interface FloorplanMedia {
  file_url: string
  alt_text?: string
  caption?: string
  media_type?: string
}

interface Props {
  floorplanImages: FloorplanMedia[]
  propertyAddress: string
}

const { floorplanImages, propertyAddress } = Astro.props

// Don't render if no floorplan images
const hasFloorplans = floorplanImages.length > 0
---

{hasFloorplans && (
  <section class="floorplan-section">
    <!-- Two-Column Layered Layout -->
    <div class="floorplan-section__layout">
      <!-- Left Column - Colored Panel -->
      <div class="floorplan-section__panel-column">
        <!-- Panel Content -->
        <div class="floorplan-section__content">
          <!-- Eyebrow Label -->
          <span class="floorplan-section__eyebrow">
            Property Layout
          </span>

          <!-- Primary Heading -->
          <h2 class="floorplan-section__heading">
            Floor Plans
          </h2>

          <!-- Body Text -->
          <p class="floorplan-section__text">
            Explore the property layout and room configurations to visualize your future space.
          </p>

          <!-- Floorplan Count Badge -->
          <div class="floorplan-section__badge">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
              <line x1="3" y1="9" x2="21" y2="9" />
              <line x1="9" y1="21" x2="9" y2="9" />
            </svg>
            <span>
              {floorplanImages.length} {floorplanImages.length === 1 ? 'Floorplan' : 'Floorplans'} Available
            </span>
          </div>
        </div>
      </div>

      <!-- Right Column - Floorplan Images (Overlapping) -->
      <div class="floorplan-section__image-column">
        <div class="floorplan-section__images" data-count={floorplanImages.length}>
          {floorplanImages.slice(0, 2).map((media, index) => (
            <a
              href={media.file_url}
              target="_blank"
              rel="noopener noreferrer"
              class={`floorplan-section__image-link ${floorplanImages.length === 1 ? 'floorplan-section__image-link--single' : ''}`}
            >
              <img
                src={media.file_url}
                alt={media.alt_text || `Floorplan for ${propertyAddress}`}
                loading="lazy"
                class="floorplan-section__image"
              />
              <!-- Hover Overlay -->
              <div class="floorplan-section__overlay">
                <span class="floorplan-section__overlay-text">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                    <polyline points="15 3 21 3 21 9" />
                    <line x1="10" y1="14" x2="21" y2="3" />
                  </svg>
                  {media.caption || 'View Full Size'}
                </span>
              </div>
            </a>
          ))}

          <!-- Show more indicator if more than 2 floorplans -->
          {floorplanImages.length > 2 && (
            <a
              href={floorplanImages[2].file_url}
              target="_blank"
              rel="noopener noreferrer"
              class="floorplan-section__more-link"
            >
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="7" />
                <rect x="14" y="3" width="7" height="7" />
                <rect x="14" y="14" width="7" height="7" />
                <rect x="3" y="14" width="7" height="7" />
              </svg>
              View All {floorplanImages.length} Floorplans
            </a>
          )}
        </div>
      </div>
    </div>
  </section>
)}

<style lang="scss">
  @use '../../styles/pages/property-details/floorplan';
</style>