---
// ========================================
// CONTACT CARD COMPONENT
// Reusable contact information card
// ========================================

interface Props {
  /** Phone number to display and link */
  phone?: string
  /** Email address to display and link */
  email?: string
  /** Card title */
  title?: string
  /** Card subtitle/description */
  subtitle?: string
  /** Email subject line (optional) */
  emailSubject?: string
  /** Phone button text (defaults to phone number) */
  phoneButtonText?: string
  /** Email button text */
  emailButtonText?: string
  /** Whether to show the card wrapper styling */
  showCard?: boolean
}

const {
  phone,
  email,
  title = 'Get in Touch',
  subtitle = 'Speak with our property experts',
  emailSubject,
  phoneButtonText,
  emailButtonText = 'Send Email',
  showCard = true,
} = Astro.props

// Format phone for tel: link (remove spaces)
const phoneLink = phone ? phone.replace(/\s/g, '') : ''

// Build email href with optional subject
const emailHref = email
  ? `mailto:${email}${emailSubject ? `?subject=${encodeURIComponent(emailSubject)}` : ''}`
  : ''

// Don't render if no contact info
const hasContactInfo = phone || email
---

{hasContactInfo && (
  showCard ? (
    <div class="sidebar-card">
      <h3 class="sidebar-card__title">{title}</h3>
      {subtitle && <p class="sidebar-card__subtitle">{subtitle}</p>}
      <div class="sidebar-card__actions">
        {phone && (
          <a href={`tel:${phoneLink}`} class="btn btn--primary">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z"/>
            </svg>
            <span>{phoneButtonText || phone}</span>
          </a>
        )}
        {email && (
          <a href={emailHref} class="btn btn--secondary">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
              <polyline points="22,6 12,13 2,6"/>
            </svg>
            <span>{emailButtonText}</span>
          </a>
        )}
      </div>
    </div>
  ) : (
    <div class="contact-card-standalone">
      <h3 class="contact-card-standalone__title">{title}</h3>
      {subtitle && <p class="contact-card-standalone__subtitle">{subtitle}</p>}
      <div class="contact-card-standalone__actions">
        {phone && (
          <a href={`tel:${phoneLink}`} class="btn btn--primary">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z"/>
            </svg>
            <span>{phoneButtonText || phone}</span>
          </a>
        )}
        {email && (
          <a href={emailHref} class="btn btn--secondary">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
              <polyline points="22,6 12,13 2,6"/>
            </svg>
            <span>{emailButtonText}</span>
          </a>
        )}
      </div>
    </div>
  )
)}


<style lang="scss">
  @use '../../styles/pages/property-details/contact-card';
</style>
