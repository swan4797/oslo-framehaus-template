// ========================================
// PROPERTY SEARCH COMPONENT
// Homepage search bar with filters
// Using centralized color tokens from tokens/_colors.scss
// ========================================

@use '../tokens/colors' as colors;
@use '../tokens/effects' as effects;
@use '../tokens/layout' as layout;
@use '../tokens/spacing' as spacing;
@use '../tokens/typography' as typography;
@use '../mixins' as *;

// ----------------------------------------
// COMPONENT VARIABLES
// ----------------------------------------

$search-padding-y: spacing.$spacing-5;
$search-padding-y-desktop: spacing.$spacing-8;
$search-padding-x: spacing.$spacing-5;
$search-field-bg: colors.$color-bg-primary;
$search-field-shadow: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.06);
$search-field-shadow-hover: 0 2px 4px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
$search-icon-color: colors.$color-text-muted;
$search-icon-size: 22px;

// ----------------------------------------
// SEARCH WRAPPER
// ----------------------------------------

.property-search {
  padding: spacing.$spacing-8 0;
  background: colors.$color-bg-secondary;

  @include md {
    padding: spacing.$spacing-10 0;
  }
}

.property-search__container {
  @include container;
}

// ----------------------------------------
// SEARCH FORM
// ----------------------------------------

.property-search__form {
  display: flex;
  flex-direction: column;
  gap: spacing.$spacing-4;

  @include lg {
    flex-direction: row;
    align-items: stretch;
    gap: spacing.$spacing-5;
  }
}

// ----------------------------------------
// SEARCH INPUT GROUP (Text + Button)
// ----------------------------------------

.property-search__input-group {
  display: flex;
  align-items: center;
  background: colors.$color-bg-secondary;
  border-radius: effects.$radius-lg;
  border: 1px solid rgba(0, 0, 0, 0.06);
  box-shadow: $search-field-shadow;
  overflow: hidden;
  flex: 1;
  min-width: 0;
  transition: box-shadow effects.$transition-fast, border-color effects.$transition-fast;

  @include lg {
    flex: 0 0 40%;
    max-width: 40%;
  }

  &:hover {
    box-shadow: $search-field-shadow-hover;
  }

  &:focus-within {
    border-color: colors.$color-primary;
    box-shadow: $search-field-shadow;
  }
}

.property-search__input-wrapper {
  display: flex;
  align-items: center;
  flex: 1;
  min-width: 0;
  padding: $search-padding-y spacing.$spacing-4;

  @include lg {
    padding: $search-padding-y-desktop $search-padding-x;
  }
}

.property-search__input-icon {
  flex-shrink: 0;
  width: $search-icon-size;
  height: $search-icon-size;
  color: $search-icon-color;
  margin-right: spacing.$spacing-3;
}

.property-search__input {
  flex: 1;
  min-width: 0;
  padding: 0;
  font-family: typography.$font-family-base;
  font-size: typography.$font-size-base;
  color: colors.$color-text-primary;
  background: colors.$color-bg-secondary;
  border: none;
  outline: none;

  @include lg {
    font-size: typography.$font-size-lg;
  }

  &::placeholder {
    color: colors.$color-text-muted;
  }
}

.property-search__submit {
  flex-shrink: 0;
  align-self: stretch;
  margin: spacing.$spacing-2;
  padding: spacing.$spacing-4 spacing.$spacing-6;
  font-family: typography.$font-family-base;
  font-size: typography.$font-size-base;
  font-weight: typography.$font-weight-semibold;
  color: colors.$color-bg-primary;
  background: colors.$color-bg-secondary;
  border: none;
  border-radius: effects.$radius-md;
  cursor: pointer;
  transition: background effects.$transition-fast, transform effects.$transition-fast;
  white-space: nowrap;

  @include lg {
    margin: spacing.$spacing-3;
    padding: spacing.$spacing-5 spacing.$spacing-8;
    font-size: typography.$font-size-lg;
  }

  &:hover {
    background: colors.$color-bg-secondary;
  }

  &:active {
    transform: scale(0.98);
  }
}

// ----------------------------------------
// FILTER DROPDOWNS
// ----------------------------------------

.property-search__filters {
  display: flex;
  flex-direction: column;
  gap: spacing.$spacing-4;

  @include sm {
    flex-direction: row;
    flex-wrap: wrap;
    gap: spacing.$spacing-4;
  }

  @include lg {
    flex: 1;
    flex-wrap: nowrap;
    gap: spacing.$spacing-5;
  }
}

.property-search__filter {
  position: relative;
  display: flex;
  align-items: center;
  gap: spacing.$spacing-3;
  padding: $search-padding-y spacing.$spacing-10 $search-padding-y $search-padding-x;
  background: colors.$color-bg-secondary;
  border: 1px solid rgba(0, 0, 0, 0.06);
  border-radius: effects.$radius-lg;
  box-shadow: $search-field-shadow;
  cursor: pointer;
  transition: box-shadow effects.$transition-fast, border-color effects.$transition-fast;
  flex: 1;
  min-width: 140px;

  @include lg {
    padding: $search-padding-y-desktop spacing.$spacing-12 $search-padding-y-desktop $search-padding-x;
  }

  // Dropdown arrow
  &::after {
    content: '';
    position: absolute;
    right: spacing.$spacing-5;
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-top: 6px solid colors.$color-text-muted;
    pointer-events: none;
  }

  &:hover {
    box-shadow: $search-field-shadow-hover;
  }

  @include sm {
    flex: 1 1 calc(33.333% - #{spacing.$spacing-4});
  }

  @include lg {
    // Each dropdown ~20% of total width (3 dropdowns = 60%)
    flex: 1 1 33.333%;
  }
}

.property-search__filter-icon {
  flex-shrink: 0;
  width: $search-icon-size;
  height: $search-icon-size;
  color: $search-icon-color;

  @include lg {
    width: 24px;
    height: 24px;
  }
}

.property-search__filter-select {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  cursor: pointer;
  font-size: typography.$font-size-base;
}

.property-search__filter-label {
  font-family: typography.$font-family-base;
  font-size: typography.$font-size-base;
  font-weight: typography.$font-weight-regular;
  color: colors.$color-text-secondary;
  white-space: nowrap;
  pointer-events: none;

  @include lg {
    font-size: typography.$font-size-lg;
  }
}

// ----------------------------------------
// ALTERNATIVE LAYOUT: CONTAINED CARD
// ----------------------------------------

.property-search--card {
  background: colors.$color-bg-secondary;
  padding: spacing.$spacing-8 0;

  @include md {
    padding: spacing.$spacing-10 0;
  }

  .property-search__form {
    background: colors.$color-bg-secondary;
    border-radius: effects.$radius-xl;
    padding: spacing.$spacing-5;
    box-shadow: effects.$shadow-lg;
    border: 1px solid rgba(0, 0, 0, 0.04);

    @include md {
      padding: spacing.$spacing-6;
    }
  }

  .property-search__input-group,
  .property-search__filter {
    border: 1px solid colors.$color-border-light;
    box-shadow: none;

    &:hover {
      box-shadow: none;
      border-color: colors.$color-border-medium;
    }

    &:focus-within {
      box-shadow: 0 0 0 3px rgba(colors.$color-primary, 0.1);
    }
  }
}

// ----------------------------------------
// ALTERNATIVE LAYOUT: MINIMAL
// ----------------------------------------

.property-search--minimal {
  padding: 0;
  background: colors.$color-bg-secondary;

  .property-search__input-group,
  .property-search__filter {
    box-shadow: none;
    border: 1px solid colors.$color-border-light;

    &:hover {
      border-color: colors.$color-border-medium;
      box-shadow: none;
    }
  }
}
